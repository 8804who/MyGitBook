### 교착 상태
- 식사하는 철학자 문제
  - 원형 식탁에 철학자들이 앉아있고 철학자의 양쪽에는 수저가 놓여있음
  - 철학자가 양손에 수저를 들면 식사를 할 수 있음
  - 이때 모든 철학자들이 각각 오른쪽에 있는 수저를 집어들면 아무도 식사를 할 수 없음(본인의 왼쪽에 앉은 사람이 수저를 집어들면 본인이 왼손에 집을 수저가 없음)
- 일어나지 않을 사건을 무한히 기다리며 진행이 멈춰버리는 현상
- 교착 상태 해결을 위해서는
  - 교착 상태가 발생했을 때의 상황을 정확히 표현해보기(자원 할당 그래프)
    - 어떤 프로세스가 어떤 자원을 할당 받아 사용 중인지 확인 가능
    - 어떤 프로세스가 어떤 자원을 기다리고 있는지 확인 가능
  - 교착 상태가 일어나는 근본적인 이유 이해하기
    - 상호 배제: 한 프로세스가 사용하는 자원을 다른 프로세스가 사용할 수 없음
    - 점유와 대기: 자원을 할당 받은 상태에서 다른 자원을 할당 받기 기다림
    - 비선점: 한 프로세스가 사용중인 자원을 빼앗을 수 없음
    - 원형 대기: 프로세스들이 원의 형태로 자원을 대기
    - 위 네가지 조건 중 하나라도 만족하지 않으면 교착 상태가 발생하지 않음
    - 위 네가지 조건을 모두 만족하면 교착 상태 발생 가능

### 교착 상태의 해결 방법
- 교착 상태 예방
  - 교착 상태가 발생하지 않도록 교착 상태의 4가지 발생 조건 중 하나를 없애버리면 됨
  - 교착 상태가 발생하지 않음은 보장할 수 있으나 부작용이 따름
  - 상호 배제
    - 모든 자원을 공유 가능하게 만들기
    - 현실적으로 불가능
  - 점유와 대기
    - 특정 프로세스에 모든 자원을 할당하거나, 아예 할당하지 않는 방식으로 자원 배분
    - 자원 활용률이 낮아질 수 있음
  - 비선점
    - 프로세스가 사용중인 자원을 빼앗을 수 있도록 함
    - 선점이 가능한 자원(ex.CPU 등)에서는 효과적
    - 하지만 모든 자원이 선점 가능한 것은 아님
  - 원형대기
    - 자원에 번호를 붙이고 순서를 지정하면 원형 대기가 발생하지 않음
    - 자원에 번호를 붙이는 것은 어려운 작엄
    - 어떤 자원에 어떤 번호를 붙이느냐에 따라 활용률이 달라짐
- 교착 상태 회피
  - 교착 상태를 무분별한 자원 할당으로 인해 발생했다고 간주
  - 교착 상태가 발생하지 않을 만큼 조심스럽게 할당
  - 배분할 수 있는 자원의 양을 고려하여 교착 상태가 발생하지 않을 만큼만 자원 배분
  - 안전 순서열: 교착 상태 없이 안전하게 프로세스들에 자원을 할당할 수 있는 순서
  - 안전 상태: 교착 상태 없이 모든 프로세스가 자우너을 할당 받고 종료될 수 있는 상태로 안전 순서열이 있는 상태
  - 불안전 상태: 교착 상태가 발생할 수 있는 상태로 안전 순서열이 없는 상태
  - 안전 상태에서 안전 상태로 움직이는 경우에만 자원을 할당하는 방식
  - 항시 안전 상태를 유지하도록 자원을 할당
  - ex. 은행원 알고리즘
    - 은행에서 고객에게 대출을 해줄 때는 해당 고객이 필요한 금액을 모두 빌려줄 수 있을때만 대출을 해줘야한다
    - 동시에 모든 고객에게 대출을 해줄 수 없을 경우 순서대로 대출을 해주며 돈을 돌려받은 뒤 다른 고객의 필요 금액을 한 번에 줄 수 있을 때 해당 고객에게 대출
- 교착 상태 검출 후 회복
  - 교착 상태의 발생을 사후에 조치하는 방식
  - 프로세스가 자원을 요구하면 일단 할당, 교착 상태 발생 시 회복
  - 선점을 통한 회복
    - 교착 상태가 회복될 때까지 한 프로세스씩 자원을 몰아주는 방식
  - 프로세스 강제 종료를 통한 회복
    - 교착 상태에 놓인 프로세스 모두 강제 종료(교착 상태를 확실히 해결할 수 있지만 작업 내역을 많이 잃을 수 있음)
    - 교착 상태가 해결될 때까지 한 프로세스씩 강제 종료(프로세스를 하나씩 종료하느라 오버헤드가 발생하지만 작업 내역을 적게 잃을 수 있음)
- 교착 상태 무시
  - 교착 상태를 해결하지 않음
  - 타조 알고리즘
    - 타조는 무서운 걸 만나면 바닥에 머리를 파묻고 아무 문제가 없는 것처럼 생각
    - 타조처럼 교착 상태가 발생해도 그냥 무시