### 프로세스 동기화
- 프로세스들의 수행 시기를 맞추는 것
- 실행 순서 제어
  - 프로세스를 올바른 순서대로 실행
  - Reader Writer problem
    - Writer: 특정 파일에 값을 저장하는 프로세스
    - Reader: 특정 파일의 값을 불러오는 프로세스
    - Reader와 Writer 프로세스는 실행의 순서가 있기 때문에 무작정 실행되어서는 안 됨
    - Reader 프로세스는 특정 파일에 값이 있어야만 실행 가능
- 상호 배제
  - 동시에 접근해서는 안 되는 자원에 하나의 프로세스만 접근 허용
  - Bank account problem
    - 공유가 불가능한 자원의 동시 사용을 피하기 위한 동기화
    - 해당 문제의 예시
      - 현재 계좌 잔액이 10만원
      - 프로세스 A는 잔액에 2만원을 더하고 프로세스 B는 잔액에 5만원을 더함
      - 프로세스 A와 B가 실행된 후에는 잔액이 17만원이 되어야함
      - 하지만 프로세스 A가 종료되기 전에 프로세스 B가 실행될 경우 프로세스 B는 현재 잔액을 10만원으로 인식
      - 이 경우 프로세스 A와 B가 실행되었지만 잔액은 15만원이됨
      - 따라서 프로세스 B는 프로세스 A가 끝난 후에 실행되어야 함
    - Proudcer & Consumer problem
      - Producer: 물건을 계속해서 생산하는 생산자(프로세스 혹은 스레드)
      - Consumer: 물건을 계속해서 소비하는 소비자(프로세스 혹은 스레드)
      - '총합' 변수 공유
      - Producer와 Consumer를 각각 10,000만번씩 실행하면 '총합'은 0이 되어야함
      - 하지만 실제 '총합' 변수는 0이 아니게 될 수 있음
      - Producer가 생산한 것이 '총합'에 반영되기 전에 Consumer 연산이 실행되거나 그 반대 경우 발생 시 총합이 맞지 않게 됨
  
### 공유 자원과 임계 구역
- 공유 자원
  - 여러 프로세스 혹은 스레드가 공유하는 자원
  - 전역 변수, 파일, 입출력장치, 보조기억장치 등등
- 임계 구역
  - 동시에 실행하면 문제가 발생하는 자원에 접근하는 코드 영역
  - Bank account problem의 '잔액'이나 Producer & Consumer problem의 '총합' 변수 등등
  - 임계 구역에 진입하고자 하면 진입한 프로세스 이외에는 대기해야 함
  - 임계 구역에 둘 이상의 프로세스가 동시에 접근하면 자원의 일관성이 깨질 수 있음(레이스 컨디션)
- 임계 구역 문제 해결을 위한 세 가지 원칙
  - 상호 배제: 한 프로세스가 임계 구역에 진입하면 다른 프로세스는 진입 불가
  - 진행: 임계 구역에 어떤 프로세스도 진입하지 않은 경우 진입하고자 하는 프로세스는 진입이 가능해야함
  - 유한 대기: 한 프로세스가 임계 구역에 진입하고 싶다면 언젠가는 임계 구역에 들어올 수 있어야함(임계 구역에 접근하기 위해 무한 대기해서는 안 됨)

### 뮤텍스 락
- 상호 배제를 위한 동기화 도구
- 뮤텍스 락의 형태
  - 필요 요소: lock 변수, acquire 함수, release 함수
  - lock 변수
    - 전역 변수로 자물쇠 역할을 수행
    - true면 임계 구역 잠겨있는 상태, false면 임계 구역 열려있는 상태
  - acquire 함수
    - 임계 구역을 잠그는 함수
    - 프로세스가 임계 구역에 진입하기 전에 호출
    - 임계 구역이 잠겨 있으면 임계 구역이 열릴 때까지 임계 구역 반복적으로 확인
    - 임계 구역이 열려 있으면 임계 구역 잠금
  - release 함수
    - 임계 구역의 잠금을 해제하는 함수
    - 임계 구역에서의 작업이 끝나고 호출
    - 현재 잠긴 임계 구역을 열기
  - 바쁜 대기(busy waiting)
    - 임계 구역이 잠겨 있는지 여부를 반복적으로 확인
    - 계속해서 lock 변수를 확인하므로 비효율적

### 세마포
- 좀 더 일반화된 방식의 동기화 도구
- 공유 자원이 여러 개 있는 경우도 적용 가능
- 임계 구역 앞에서 멈춤 신호를 받으면 대기
- 임계 구역 앞에서 진입 신호를 받으면 진입
- 세마포의 단순한 형태
  - 전역 변수 S
    - 임계 구역에 진입 가능한 프로세스의 개수
  - wait 함수
    - 임계 구역 진입 가능 여부를 알려주는 함수
  - signal 함수
    - 대기 중인 프로세스에 임계 구역 진입 신호를 주는 signal 함수
  - 세마포의 단계
    - 프로세스 1이 wait 호출, S가 1 이상이면 S를 1 감소시키고 임계 구역 진입
    - 프로세스 2가 wait 호출, S가 0이면 무한히 반복하며 S 확인
    - 프로세스 1의 작업이 종료되면 signal 호출, S가 1 증가
    - 프로세스 2가 S가 1이 됨을 확인, S를 1 감소시키고 임계 구역 진입

### 모니터
- 사용자가 다루기에 편한 동기화 도구
- 상호 배제를 위한 동기화
  - 인터페이스를 위한 큐
  - 공유자원에 접근하고자 하는 프로세스를 (인터페이스를 위한)큐에 삽입
  - 큐에 삽입된 순서대로(한 번에 하나의 프로세스만) 공유 자원 이용
- 실행 순서 제어를 위한 동기화
  - 조건 변수(프로세스나 스레드의 실행 순서를 제어하기 위해 사용하는 특별한 변수) 이용
  - 조건 변수.wait 함수: 대기 상태로 변경, 조건 변수에 대한 큐에 삽입
  - 조건 변수.signal 함수: wait으로 대기 상태로 접어든 조건 변수를 실행 상태로 변경
  - 모니터 안에는 하나의 프로세스만 존재 가능
    - wait을 호출했던 프로세스는 signal을 호출한 프로세스가 모니터를 떠난 후에 작업 재개
    - signal 호출한 프로세스의 실행을 일시 중단하고 자신이 실행된 뒤 다시 signal을 호출한 프로세스 수행 재개
  - 특정 프로세스가 실행될 조건이 되지 않았으면 wait을 통해 실행 준단
  - 특정 프로세스가 실행될 조건이 충족되면 signal을 통해 실행 재개